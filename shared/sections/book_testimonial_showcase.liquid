<section class="book-testimonial-showcase" style="background-color: {{ section.settings.right_bg_color | default: '#F5F5F0' }};">
  <div class="book-testimonial-showcase__wrapper">
    <!-- Left Side - Book Showcase -->
    <div class="book-testimonial-showcase__left" style="background-color: {{ section.settings.left_bg_color | default: '#E6FF69' }};">
      <div class="book-testimonial-showcase__content">
        {% if section.settings.book_image %}
          <div class="book-testimonial-showcase__book">
            <img src="{{ section.settings.book_image | image_url }}" alt="{{ section.settings.book_title | default: 'Book cover' }}" loading="lazy">
            {% if section.settings.bestseller_badge %}
              <div class="book-testimonial-showcase__badge">
                <span class="badge-number">{{ section.settings.badge_number | default: '#1' }}</span>
                <span class="badge-text">{{ section.settings.badge_text | default: 'New York Times BESTSELLER' }}</span>
              </div>
            {% endif %}
          </div>
        {% endif %}
        
        <div class="book-testimonial-showcase__info">
          <h2 class="book-testimonial-showcase__title">{{ section.settings.book_title | default: 'Everything Is Figureoutable' }}</h2>
          
          {% if section.settings.subtitle %}
            <p class="book-testimonial-showcase__subtitle">{{ section.settings.subtitle }}</p>
          {% endif %}
          
          <p class="book-testimonial-showcase__description">{{ section.settings.description | default: "It's more than just a fun phrase to say. It's a philosophy of relentless optimism. A mindset. A mantra. A conviction. Most important, it's about to make you unstoppable." }}</p>
          
          {% if section.settings.availability_text %}
            <p class="book-testimonial-showcase__availability">
              {{ section.settings.availability_text | replace: 'Everything is Figureoutable', '<em>Everything is Figureoutable</em>' }}
            </p>
          {% endif %}
          
          {% if section.settings.cta_text and section.settings.cta_url %}
            <a href="{{ section.settings.cta_url }}" class="btn btn-dark book-testimonial-showcase__cta">
              {{ section.settings.cta_text }}
            </a>
          {% endif %}
        </div>
      </div>
    </div>
    
    <!-- Right Side - Testimonial Slider -->
    <div class="book-testimonial-showcase__right">
      <div class="book-testimonial-showcase__testimonials">
        {% if section.settings.testimonial_logo %}
          <div class="testimonial-logo">
            <img src="{{ section.settings.testimonial_logo | image_url }}" alt="{{ section.settings.testimonial_logo_alt | default: 'Logo' }}" loading="lazy">
          </div>
        {% endif %}
        
        <div class="testimonial-slider" data-autoplay="{{ section.settings.autoplay | default: true }}" data-autoplay-speed="{{ section.settings.autoplay_speed | default: 5000 }}">
          {% for block in section.blocks %}
            {% if block.type == 'testimonial' %}
              <div class="testimonial-slide">
                <blockquote class="testimonial-quote">
                  "{{ block.settings.quote }}"
                </blockquote>
                
                <div class="testimonial-author">
                  <div class="testimonial-author__info">
                    <h4 class="testimonial-author__name">{{ block.settings.author_name }}</h4>
                    {% if block.settings.author_title %}
                      <p class="testimonial-author__title">{{ block.settings.author_title }}</p>
                    {% endif %}
                  </div>
                  {% if block.settings.author_image %}
                    <div class="testimonial-author__avatar">
                      <img src="{{ block.settings.author_image | image_url }}" alt="{{ block.settings.author_name }}" loading="lazy">
                    </div>
                  {% endif %}
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
        
        <!-- Slider dots -->
        <div class="testimonial-dots"></div>
      </div>
    </div>
  </div>
</section>

<style>
  .book-testimonial-showcase {
    position: relative;
    overflow: hidden;
  }
  
  .book-testimonial-showcase__wrapper {
    display: flex;
    min-height: 600px;
  }
  
  .book-testimonial-showcase__left,
  .book-testimonial-showcase__right {
    flex: 1;
    padding: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .book-testimonial-showcase__content {
    max-width: 560px;
    width: 100%;
  }
  
  .book-testimonial-showcase__book {
    position: relative;
    margin-bottom: 40px;
  }
  
  .book-testimonial-showcase__book img {
    max-width: 300px;
    width: 100%;
    height: auto;
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    border-radius: 4px;
  }
  
  .book-testimonial-showcase__badge {
    position: absolute;
    bottom: 20px;
    right: -20px;
    background: #000;
    color: #fff;
    padding: 15px 20px;
    border-radius: 50%;
    width: 120px;
    height: 120px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    font-size: 11px;
    line-height: 1.2;
  }
  
  .badge-number {
    font-size: 24px;
    font-weight: 700;
    display: block;
    margin-bottom: 5px;
  }
  
  .badge-text {
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  
  .book-testimonial-showcase__title {
    font-size: 48px;
    font-weight: 700;
    line-height: 1.1;
    margin-bottom: 20px;
    color: #000;
  }
  
  .book-testimonial-showcase__subtitle {
    font-size: 18px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 20px;
  }
  
  .book-testimonial-showcase__description {
    font-size: 18px;
    line-height: 1.6;
    margin-bottom: 20px;
  }
  
  .book-testimonial-showcase__availability {
    font-size: 16px;
    font-style: italic;
    margin-bottom: 30px;
  }
  
  .book-testimonial-showcase__availability em {
    font-style: normal;
    font-weight: 600;
  }
  
  .book-testimonial-showcase__cta {
    background: #000;
    color: #fff;
    padding: 16px 32px;
    border-radius: 30px;
    font-weight: 600;
    text-decoration: none;
    display: inline-block;
    transition: transform 0.2s ease;
  }
  
  .book-testimonial-showcase__cta:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }
  
  /* Testimonial Side */
  .book-testimonial-showcase__testimonials {
    max-width: 560px;
    width: 100%;
    text-align: center;
  }
  
  .testimonial-logo {
    margin-bottom: 40px;
  }
  
  .testimonial-logo img {
    height: 30px;
    width: auto;
  }
  
  .testimonial-slider {
    position: relative;
    overflow: hidden;
  }
  
  .testimonial-slide {
    display: none;
  }
  
  .testimonial-slide.active {
    display: block;
  }
  
  .testimonial-quote {
    font-size: 24px;
    line-height: 1.5;
    margin-bottom: 40px;
    quotes: none;
  }
  
  .testimonial-author {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
  }
  
  .testimonial-author__info {
    text-align: right;
  }
  
  .testimonial-author__name {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 5px;
  }
  
  .testimonial-author__title {
    font-size: 14px;
    color: #666;
    font-style: italic;
  }
  
  .testimonial-author__avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    overflow: hidden;
  }
  
  .testimonial-author__avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  /* Slider dots */
  .testimonial-dots {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 30px;
  }
  
  .testimonial-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #ddd;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  
  .testimonial-dot.active {
    background: #333;
  }
  
  /* Responsive */
  @media (max-width: 991px) {
    .book-testimonial-showcase__wrapper {
      flex-direction: column;
    }
    
    .book-testimonial-showcase__left,
    .book-testimonial-showcase__right {
      padding: 40px;
    }
    
    .book-testimonial-showcase__title {
      font-size: 36px;
    }
    
    .testimonial-quote {
      font-size: 20px;
    }
  }
  
  @media (max-width: 767px) {
    .book-testimonial-showcase__left,
    .book-testimonial-showcase__right {
      padding: 30px 20px;
    }
    
    .book-testimonial-showcase__title {
      font-size: 28px;
    }
    
    .book-testimonial-showcase__book img {
      max-width: 200px;
    }
    
    .book-testimonial-showcase__badge {
      width: 90px;
      height: 90px;
      font-size: 9px;
      padding: 10px;
      right: -10px;
    }
    
    .badge-number {
      font-size: 18px;
    }
    
    .testimonial-author {
      flex-direction: column-reverse;
      text-align: center;
    }
    
    .testimonial-author__info {
      text-align: center;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const slider = document.querySelector('.testimonial-slider');
    if (!slider) return;
    
    const slides = slider.querySelectorAll('.testimonial-slide');
    const dotsContainer = document.querySelector('.testimonial-dots');
    const autoplay = slider.dataset.autoplay === 'true';
    const autoplaySpeed = parseInt(slider.dataset.autoplaySpeed) || 5000;
    
    let currentSlide = 0;
    let autoplayInterval;
    
    // Create dots
    slides.forEach((_, index) => {
      const dot = document.createElement('div');
      dot.classList.add('testimonial-dot');
      if (index === 0) dot.classList.add('active');
      dot.addEventListener('click', () => goToSlide(index));
      dotsContainer.appendChild(dot);
    });
    
    const dots = dotsContainer.querySelectorAll('.testimonial-dot');
    
    function goToSlide(index) {
      slides[currentSlide].classList.remove('active');
      dots[currentSlide].classList.remove('active');
      
      currentSlide = index;
      
      slides[currentSlide].classList.add('active');
      dots[currentSlide].classList.add('active');
    }
    
    function nextSlide() {
      const next = (currentSlide + 1) % slides.length;
      goToSlide(next);
    }
    
    // Initialize first slide
    if (slides.length > 0) {
      slides[0].classList.add('active');
    }
    
    // Start autoplay
    if (autoplay && slides.length > 1) {
      autoplayInterval = setInterval(nextSlide, autoplaySpeed);
      
      // Pause on hover
      slider.addEventListener('mouseenter', () => clearInterval(autoplayInterval));
      slider.addEventListener('mouseleave', () => {
        autoplayInterval = setInterval(nextSlide, autoplaySpeed);
      });
    }
  });
</script>

{% schema %}
{
  "name": "Book - Testimonial Showcase",
  "elements": [
    {
      "type": "header",
      "content": "Book Section"
    },
    {
      "type": "color",
      "id": "left_bg_color",
      "label": "Left Background Color",
      "default": "#E6FF69"
    },
    {
      "type": "image_picker",
      "id": "book_image",
      "label": "Book Cover Image"
    },
    {
      "type": "text",
      "id": "book_title",
      "label": "Book Title",
      "default": "Everything Is Figureoutable"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "#1 NEW YORK TIMES BESTSELLER"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Book Description",
      "default": "It's more than just a fun phrase to say. It's a philosophy of relentless optimism. A mindset. A mantra. A conviction. Most important, it's about to make you unstoppable."
    },
    {
      "type": "text",
      "id": "availability_text",
      "label": "Availability Text",
      "default": "Everything is Figureoutable is NOW AVAILABLE."
    },
    {
      "type": "text",
      "id": "cta_text",
      "label": "CTA Button Text",
      "default": "Tell Me Everything"
    },
    {
      "type": "text",
      "id": "cta_url",
      "label": "CTA Button URL",
      "default": "#"
    },
    {
      "type": "checkbox",
      "id": "bestseller_badge",
      "label": "Show Bestseller Badge",
      "default": true
    },
    {
      "type": "text",
      "id": "badge_number",
      "label": "Badge Number",
      "default": "#1"
    },
    {
      "type": "text",
      "id": "badge_text",
      "label": "Badge Text",
      "default": "New York Times BESTSELLER"
    },
    {
      "type": "header",
      "content": "Testimonial Section"
    },
    {
      "type": "color",
      "id": "right_bg_color",
      "label": "Right Background Color",
      "default": "#F5F5F0"
    },
    {
      "type": "image_picker",
      "id": "testimonial_logo",
      "label": "Testimonial Section Logo"
    },
    {
      "type": "text",
      "id": "testimonial_logo_alt",
      "label": "Logo Alt Text",
      "default": "The Copy Cure"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay Testimonials",
      "default": true
    },
    {
      "type": "range",
      "id": "autoplay_speed",
      "label": "Autoplay Speed (ms)",
      "min": 3000,
      "max": 10000,
      "step": 1000,
      "default": 5000
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "elements": [
        {
          "type": "textarea",
          "id": "quote",
          "label": "Quote",
          "default": "I had a $25,000 launch thanks to The Copy Cure...I LOVED the way the course is hilarious and interactive. DOOOO IIITTTT!!!!! It is one of the most revolutionary mind shifts in communication and marketing your business."
        },
        {
          "type": "text",
          "id": "author_name",
          "label": "Author Name",
          "default": "Hugette Montesinos-Rodriguez"
        },
        {
          "type": "text",
          "id": "author_title",
          "label": "Author Title",
          "default": "Editor-in-Chief, DiSFunkshion Magazine, Miami, Florida USA"
        },
        {
          "type": "image_picker",
          "id": "author_image",
          "label": "Author Avatar"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Book Testimonial Showcase",
      "category": "Content",
      "description": "Split layout with book showcase and testimonial slider",
      "blocks": [
        {
          "type": "testimonial"
        }
      ]
    }
  ]
}
{% endschema %}