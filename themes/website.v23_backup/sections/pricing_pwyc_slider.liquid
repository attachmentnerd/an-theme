{% comment %}
  Pricing - PWYC (Unified Slider)
  - Combines features from "Slider" and "Simple" variants
  - Bullet-proof checkout: Kajabi API > pre-bound action anchors > URL
  - Quick buttons + slider + right-hand tier cards (all selectable)
  - Accessible, keyboard-friendly, localStorage memory, query preselect
{% endcomment %}

<section id="pwyc-unified-{{ section.id }}" class="an-section an-theme"
         style="background: var(--c-white,#fff); color: var(--c-ink-900,#1B1B29)"
         data-url-floor="{{ section.settings.checkout_url_floor }}"
         data-url-anchor="{{ section.settings.checkout_url_anchor }}"
         data-url-forward="{{ section.settings.checkout_url_forward }}"
         data-offer-floor="{{ section.settings.kajabi_offer_floor }}"
         data-offer-anchor="{{ section.settings.kajabi_offer_anchor }}"
         data-offer-forward="{{ section.settings.kajabi_offer_forward }}">
  <div class="an-container">
    <div class="pwyc-grid">
      <!-- LEFT: Slider + readout + actions -->
      <div class="an-card">
        {% if section.settings.eyebrow != blank %}
          <div class="an-eyebrow">{{ section.settings.eyebrow }}</div>
        {% endif %}
        <h2 class="an-title-lg pwyc-heading">{{ section.settings.heading }}</h2>
        {% if section.settings.subheading != blank %}
          <p class="pwyc-sub">{{ section.settings.subheading }}</p>
        {% endif %}

        <!-- Quick tier buttons -->
        <div class="pwyc-quick" role="tablist" aria-label="Quick pricing tiers">
          <button type="button" class="an-btn-secondary pwyc-quick-btn" data-tier="{{ section.settings.min_value }}" data-evt="pwyc_tier_click" data-label="{{ section.settings.min_value }}">{{ section.settings.currency_symbol }}{{ section.settings.min_value }} — {{ section.settings.floor_title }}</button>
          <button type="button" class="an-btn-secondary pwyc-quick-btn" data-tier="{{ section.settings.anchor_value }}" data-evt="pwyc_tier_click" data-label="{{ section.settings.anchor_value }}">{{ section.settings.currency_symbol }}{{ section.settings.anchor_value }} — {{ section.settings.anchor_title }} <span class="pwyc-badge">{{ section.settings.anchor_label }}</span></button>
          <button type="button" class="an-btn-secondary pwyc-quick-btn" data-tier="{{ section.settings.max_value }}" data-evt="pwyc_tier_click" data-label="{{ section.settings.max_value }}">{{ section.settings.currency_symbol }}{{ section.settings.max_value }} — {{ section.settings.forward_title }}</button>
        </div>

        <!-- Slider -->
        <div class="pwyc-slider-wrap">
          <label id="pwyc-unified-slider-label-{{ section.id }}" class="sr-only" for="pwyc-unified-slider-input-{{ section.id }}">Choose your price</label>
          <input id="pwyc-unified-slider-input-{{ section.id }}" type="range"
                 min="{{ section.settings.min_value }}" max="{{ section.settings.max_value }}" step="1"
                 value="{{ section.settings.default_value }}"
                 class="pwyc-slider" role="slider" aria-orientation="horizontal"
                 aria-labelledby="pwyc-unified-slider-label-{{ section.id }}"
                 aria-valuemin="{{ section.settings.min_value }}"
                 aria-valuemax="{{ section.settings.max_value }}"
                 aria-valuenow="{{ section.settings.default_value }}">
        </div>
        <div class="pwyc-scale">
          <span>{{ section.settings.currency_symbol }}{{ section.settings.min_value }}</span>
          <span>{{ section.settings.currency_symbol }}{{ section.settings.anchor_value }}</span>
          <span>{{ section.settings.currency_symbol }}{{ section.settings.max_value }}</span>
        </div>

        <!-- Live price + chip -->
        <div class="pwyc-readout" id="pwyc-unified-readout-{{ section.id }}" aria-live="polite" aria-atomic="true" role="status">
          <div class="pwyc-price" id="pwyc-unified-price-{{ section.id }}">{{ section.settings.currency_symbol }}{{ section.settings.default_value }}</div>
          <span class="an-chip" id="pwyc-unified-label-{{ section.id }}">{{ section.settings.anchor_label }}</span>
        </div>
        <p class="pwyc-desc" id="pwyc-unified-desc-{{ section.id }}">{{ section.settings.anchor_desc }}</p>

        <!-- CTAs -->
        <div class="pwyc-cta">
          <a id="pwyc-unified-cta-{{ section.id }}"
             href="{{ section.settings.checkout_url_anchor }}"
             class="an-btn-primary"
             data-evt="pwyc_checkout_click"
             data-label="slider"
             aria-describedby="pwyc-unified-desc-{{ section.id }}"
             aria-label="{{ section.settings.primary_cta_text }} at {{ section.settings.currency_symbol }}{{ section.settings.default_value }}">
            {{ section.settings.primary_cta_text }}
          </a>
          {% if section.settings.show_scholarship %}
            <a href="{{ section.settings.scholarship_link }}" class="an-btn-secondary" data-evt="pwyc_cta" data-label="scholarship_link">{{ section.settings.scholarship_text }}</a>
          {% endif %}
        </div>

        {% if section.settings.whats_included != blank %}
          <div class="pwyc-included">
            <strong>{{ section.settings.whats_included_heading }}</strong> {{ section.settings.whats_included }}
          </div>
        {% endif %}

        {% if section.settings.show_scholarship_panel %}
          <div class="pwyc-scholarship-panel">
            <h3>{{ section.settings.scholarship_panel_heading }}</h3>
            <p>{{ section.settings.scholarship_panel_intro }}</p>
            <ul>
              <li>{{ section.settings.scholarship_bullet_one }}</li>
              <li>{{ section.settings.scholarship_bullet_two }}</li>
              <li>{{ section.settings.scholarship_bullet_three }}</li>
            </ul>
            <a href="{{ section.settings.scholarship_link }}" class="an-btn-secondary" data-evt="pwyc_cta" data-label="scholarship_panel">{{ section.settings.scholarship_panel_cta }}</a>
          </div>
        {% endif %}

        {% if section.settings.show_bottom_note %}
          <p class="pwyc-note" id="pwyc-unified-note-{{ section.id }}">
            {{ section.settings.bottom_note | replace: '[[link]]', '<a href="' | append: section.settings.bottom_note_link | append: '" data-evt="pwyc_cta" data-label="scholarship_request">' | append: section.settings.bottom_note_link_text | append: '</a>' }}
          </p>
        {% endif %}
      </div>

      <!-- RIGHT: Clickable tier cards -->
      <div>
        <div class="pwyc-tiers">
          <div class="an-card pwyc-tier" data-tier="{{ section.settings.min_value }}">
            <div class="pwyc-tier-eyebrow">{{ section.settings.floor_title }}</div>
            <div class="pwyc-tier-amount">{{ section.settings.currency_symbol }}{{ section.settings.min_value }}</div>
            <p class="pwyc-tier-desc">{{ section.settings.floor_desc }}</p>
          </div>
          <div class="an-card pwyc-tier pwyc-tier--anchor" data-tier="{{ section.settings.anchor_value }}">
            <div class="pwyc-tier-eyebrow">{{ section.settings.anchor_title }}</div>
            <div class="pwyc-tier-amount">{{ section.settings.currency_symbol }}{{ section.settings.anchor_value }}</div>
            <p class="pwyc-tier-desc">{{ section.settings.anchor_desc }}</p>
          </div>
          <div class="an-card pwyc-tier" data-tier="{{ section.settings.max_value }}">
            <div class="pwyc-tier-eyebrow">{{ section.settings.forward_title }}</div>
            <div class="pwyc-tier-amount">{{ section.settings.currency_symbol }}{{ section.settings.max_value }}</div>
            <p class="pwyc-tier-desc">{{ section.settings.forward_desc }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pre-bound hidden anchors so Kajabi action tokens work -->
  <a class="sr-only pwyc-action pwyc-action--floor"   href="{{ section.settings.checkout_url_floor }}"></a>
  <a class="sr-only pwyc-action pwyc-action--anchor"  href="{{ section.settings.checkout_url_anchor }}"></a>
  <a class="sr-only pwyc-action pwyc-action--forward" href="{{ section.settings.checkout_url_forward }}"></a>

  <style>
    /* Unified visual language */
    #pwyc-unified-{{ section.id }}{color:var(--c-ink-900);--pwyc-accent: {{ section.settings.anchor_color | default: 'var(--c-brand-600)' }}}
    #pwyc-unified-{{ section.id }} a{color:inherit}
    #pwyc-unified-{{ section.id }} .sr-only{position:absolute!important;width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}

    .pwyc-grid{display:grid;gap:16px;grid-template-columns:1.2fr .8fr}
    .pwyc-heading{margin-bottom:4px}
    .pwyc-sub{font-size:.9rem;color:var(--c-ink-500)}
    .pwyc-slider-wrap{margin:16px 0 8px}
    .pwyc-slider{appearance:none;width:100%;height:8px;border-radius:8px;background:#F0EDFF;outline:none}
    .pwyc-slider::-webkit-slider-thumb{appearance:none;width:20px;height:20px;border-radius:50%;background:var(--pwyc-accent);box-shadow:0 0 0 0 rgba(94,59,255,0.35);transition:transform var(--duration-fast) var(--motion-ease-standard), box-shadow var(--duration-fast) var(--motion-ease-standard)}
    .pwyc-slider:active::-webkit-slider-thumb{transform:scale(1.05)}
    .pwyc-slider:focus-visible::-webkit-slider-thumb{box-shadow:0 0 0 4px rgba(94,59,255,0.25)}
    .pwyc-slider::-moz-range-thumb{width:20px;height:20px;border:none;border-radius:50%;background:var(--pwyc-accent);transition:transform var(--duration-fast) var(--motion-ease-standard)}
    .pwyc-slider:focus-visible::-moz-range-thumb{outline:none;box-shadow:0 0 0 4px rgba(94,59,255,0.25)}
    .pwyc-scale{display:flex;justify-content:space-between;font-size:12px;color:var(--c-ink-500);margin-top:6px}

    .pwyc-readout{display:flex;align-items:center;gap:10px;margin:12px 0 8px;padding:8px 10px;border-radius:12px;border:1px solid transparent}
    .pwyc-price{font-size:28px;font-weight:700;color:var(--c-ink-900)}
    .pwyc-desc{font-size:.9rem;color:var(--c-ink-500)}
    .pwyc-cta{margin-top:14px;display:flex;gap:10px;flex-wrap:wrap}
    .pwyc-cta a:focus-visible{box-shadow:0 0 0 3px rgba(94,59,255,0.3);outline:0}

    /* Accent color drives primary CTA and links */
    #pwyc-unified-{{ section.id }} .an-btn-primary{background:var(--pwyc-accent)!important;border-color:var(--pwyc-accent)!important;color:var(--c-white)!important}
    #pwyc-unified-{{ section.id }} .an-btn-primary:hover{filter:brightness(.95)}
    #pwyc-unified-{{ section.id }} .pwyc-note a{color:var(--pwyc-accent);text-decoration:underline}
    #pwyc-unified-{{ section.id }} .pwyc-cta [data-label="scholarship_link"]{color:var(--pwyc-accent)!important;border-color:var(--pwyc-accent)!important;font-size:.9rem;padding:.5rem .75rem}

    .pwyc-included{margin-top:14px;background:linear-gradient(145deg,#EDEBFF,#F7F6FF);border-radius:16px;padding:12px}

    /* Quick buttons */
    .pwyc-quick{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
    .pwyc-quick-btn{border-color:var(--border-medium)!important}
    .pwyc-quick-btn.is-active{background:var(--pwyc-accent)!important;color:var(--c-white)!important;border-color:var(--pwyc-accent)!important}
    .pwyc-quick-btn .pwyc-badge{font-size:11px;margin-left:6px;color:var(--c-ink-500)}

    /* Tier cards */
    .pwyc-tiers{display:flex;flex-wrap:wrap;gap:10px}
    .pwyc-tier{flex:1 1 180px;cursor:pointer;border:1px solid var(--border-medium);border-radius:12px;padding:12px;background:var(--c-white)}
    .pwyc-tier.is-active{outline:2px solid var(--pwyc-accent);box-shadow:0 0 0 4px rgba(94,59,255,0.06)}
    .pwyc-tier--anchor{border:1px solid var(--c-brand-600);box-shadow:var(--glow-brand)}
    .pwyc-tier-eyebrow{font-size:.85rem;color:var(--c-ink-500)}
    .pwyc-tier-amount{font-size:24px;font-weight:700;color:var(--c-ink-900)}
    .pwyc-tier-desc{font-size:.9rem;color:var(--c-ink-500)}

    .pwyc-scholarship-panel{margin-top:16px;padding:14px;border:1px solid var(--border-medium);border-radius:16px;background:linear-gradient(145deg,#F8F8FF,#FFFFFF)}
    .pwyc-scholarship-panel h3{margin:0 0 6px;font-size:1.1rem;color:var(--c-ink-900)}
    .pwyc-scholarship-panel p{margin:0 0 8px;color:var(--c-ink-700)}
    .pwyc-scholarship-panel ul{margin:0 0 8px;padding-left:18px;color:var(--c-ink-700)}

    /* Highlight price box by tier */
    #pwyc-unified-{{ section.id }}[data-tier-key] .pwyc-readout{border-color:var(--pwyc-accent);box-shadow:0 0 0 4px rgba(94,59,255,0.06)}

    @media (max-width: 900px){.pwyc-grid{grid-template-columns:1fr}}
    @media (max-width: 600px){
      .pwyc-cta{flex-direction:column}
      .pwyc-cta a{width:100%}
    }
  </style>

  <script>
    (function(){
      var ROOT_ID = 'pwyc-unified-{{ section.id }}';

      function isKajabiModalOpen(){
        try{ return !!document.querySelector('.modal.is-active, .kjb-modal.is-active, .checkout-modal.is-active, [data-behavior*="modal"].is-active'); }catch(e){ return false; }
      }
      function tryCloseKajabiModal(){
        try{
          var closeBtn = document.querySelector('.modal.is-active [data-behavior="modal-close"], .kjb-modal.is-active [data-behavior="modal-close"], .is-active .modal-close, .checkout-modal.is-active .modal-close');
          if(closeBtn){ closeBtn.click(); }
        }catch(e){}
      }

      function initPWYC(){
        var root = document.getElementById(ROOT_ID);
        if(!root || root.dataset.inited === '1') return; root.dataset.inited = '1';

        var slider   = root.querySelector('#pwyc-unified-slider-input-{{ section.id }}');
        var price    = root.querySelector('#pwyc-unified-price-{{ section.id }}');
        var label    = root.querySelector('#pwyc-unified-label-{{ section.id }}');
        var desc     = root.querySelector('#pwyc-unified-desc-{{ section.id }}');
        var checkout = root.querySelector('#pwyc-unified-cta-{{ section.id }}');

        if(!slider || !price || !label || !desc || !checkout) return;

        var quickButtons = Array.prototype.slice.call(root.querySelectorAll('[data-tier]'));
        var quickCards   = Array.prototype.slice.call(root.querySelectorAll('.pwyc-tier'));

        var currency   = {{ section.settings.currency_symbol | json }};
        var storageKey = 'pwyc:unified:lastSelected:{{ section.id }}';

        var colors = {
          floor:   {{ section.settings.floor_color   | default: 'var(--c-accent-teal)'  | json }},
          anchor:  {{ section.settings.anchor_color  | default: 'var(--c-brand-600)'    | json }},
          forward: {{ section.settings.forward_color | default: 'var(--c-accent-lemon)' | json }}
        };

        var tiers = [
          {
            v: {{ section.settings.min_value   | default: 49  }},
            key:'floor',
            chip:  {{ section.settings.floor_title   | json }},
            title: {{ section.settings.floor_title   | json }},
            desc:  {{ section.settings.floor_desc    | json }},
            url:   root.dataset.urlFloor,
            offer: root.dataset.offerFloor
          },
          {
            v: {{ section.settings.anchor_value| default: 297 }},
            key:'anchor',
            chip:  {{ section.settings.anchor_label  | json }},
            title: {{ section.settings.anchor_title  | json }},
            desc:  {{ section.settings.anchor_desc   | json }},
            url:   root.dataset.urlAnchor,
            offer: root.dataset.offerAnchor
          },
          {
            v: {{ section.settings.max_value   | default: 449 }},
            key:'forward',
            chip:  {{ section.settings.forward_title | json }},
            title: {{ section.settings.forward_title | json }},
            desc:  {{ section.settings.forward_desc  | json }},
            url:   root.dataset.urlForward,
            offer: root.dataset.offerForward
          }
        ];

        var actionLinks = {
          floor:   root.querySelector('.pwyc-action--floor'),
          anchor:  root.querySelector('.pwyc-action--anchor'),
          forward: root.querySelector('.pwyc-action--forward')
        };

        function isActionToken(u){ return typeof u === 'string' && u.charAt(0) === '#'; }
        function isUrl(u){ return typeof u === 'string' && /^(https?:\/\/|\/|\?)/i.test(u); }

        function closestTier(val){
          return tiers.reduce(function(best, t){
            return Math.abs(t.v - val) < Math.abs(best.v - val) ? t : best;
          }, tiers[0]);
        }

        function applyAccentForTier(t){
          try {
            root.style.setProperty('--pwyc-accent', colors[t.key] || colors.anchor);
            root.setAttribute('data-tier-key', t.key);
          } catch(e) {}
        }

        function toggleActiveStates(selectedV){
          // Quick buttons
          Array.prototype.slice.call(root.querySelectorAll('.pwyc-quick-btn')).forEach(function(btn){
            var isActive = parseInt(btn.dataset.tier, 10) === selectedV;
            btn.classList.toggle('is-active', isActive);
            btn.setAttribute('aria-pressed', isActive ? 'true' : 'false');
          });
          // Tier cards
          quickCards.forEach(function(card){
            var isActive = parseInt(card.dataset.tier, 10) === selectedV;
            card.classList.toggle('is-active', isActive);
          });
        }

        var currentTier = null;

        function render(t, opts){
          price.textContent = currency + t.v;
          label.textContent = t.chip;
          desc.textContent  = t.desc;

          // Only set href for true URLs. For action tokens, remove href and handle on click.
          if (t.url && isUrl(t.url)) checkout.href = t.url; else checkout.removeAttribute('href');

          slider.value = String(t.v);
          slider.setAttribute('aria-valuenow', String(t.v));
          slider.setAttribute('aria-valuetext', currency + t.v + ' — ' + t.chip);
          checkout.setAttribute('data-value', String(t.v));
          checkout.setAttribute('aria-label', {{ section.settings.primary_cta_text | json }} + ' at ' + currency + t.v + ' — ' + t.chip);

          applyAccentForTier(t);
          toggleActiveStates(t.v);
          currentTier = t;

          try { localStorage.setItem(storageKey, String(t.v)); } catch(e){}

          try {
            if(window.gtag){ gtag('event','pwyc_view',{ value:t.v, tier_key:t.key }); }
          } catch(e){}

          if(opts && opts.focusCta){
            if(isKajabiModalOpen()) return;
            var prefersReduced = false;
            try { prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches; } catch(err){}
            if(prefersReduced){ checkout.focus(); }
            else { tryCloseKajabiModal(); checkout.scrollIntoView({behavior:'smooth', block:'center'}); }
          }
        }

        function openCheckoutFor(t, e){
          var u = t && t.url || '';
          var offer = t && t.offer;

          // 1) Prefer Kajabi API if offer id is provided
          try {
            if (offer && window.Kajabi && Kajabi.checkout && typeof Kajabi.checkout.open === 'function') {
              if (e) e.preventDefault();
              Kajabi.checkout.open({ offer_id: offer });
              return;
            }
          } catch(_){ }

          // 2) If it's an action token, click the pre-bound hidden link
          if (isActionToken(u)) {
            if (e) e.preventDefault();
            var link = actionLinks[t.key];
            if (link) { link.click(); }
            return;
          }

          // 3) If it's a normal URL, let the anchor navigate (no preventDefault)
          if (isUrl(u)) return;

          // 4) Nothing configured: prevent dead click and log
          if (e) e.preventDefault();
          console.error('PWYC unified: missing checkout url/action/offer for tier:', t.key);
        }

        function selectByValue(value, source){
          var t = closestTier(parseInt(value,10));
          render(t, { focusCta: source !== 'slider' });
          try {
            if(window.gtag){ gtag('event','pwyc_tier_click',{ value:t.v, tier_key:t.key, source:source }); }
          } catch(e){}
          try { if(navigator.vibrate){ navigator.vibrate(8); } } catch(e){}
        }

        // Initial render: query param > stored > default slider
        var storedVal = (function(){ try{ var v = parseInt(localStorage.getItem(storageKey),10); return isNaN(v) ? null : v; } catch(e){ return null; }})();
        var initial   = closestTier(storedVal != null ? storedVal : parseInt(slider.value,10));
        try{
          var qp = new URLSearchParams(window.location.search);
          var qpVal = qp.get('tier') || qp.get('pwyc') || qp.get('amount');
          if(qpVal){
            var byKey = tiers.find(function(t){ return t.key === String(qpVal).toLowerCase(); });
            if(byKey) initial = byKey; else { var n = parseInt(qpVal,10); if(!isNaN(n)) initial = closestTier(n); }
          }
        }catch(e){}
        render(initial);

        // Events
        slider.addEventListener('input', function(){ selectByValue(slider.value, 'slider'); });

        Array.prototype.slice.call(root.querySelectorAll('.pwyc-quick-btn')).forEach(function(btn){
          btn.addEventListener('click', function(e){ e.preventDefault(); e.stopPropagation(); selectByValue(btn.dataset.tier, 'button'); });
          btn.addEventListener('keydown', function(e){ var k=e.key||e.code; if(k===' '||k==='Spacebar'||k==='Enter'){ e.preventDefault(); selectByValue(btn.dataset.tier, 'button_kbd'); }});
        });

        quickCards.forEach(function(card){
          card.setAttribute('role','button'); card.setAttribute('tabindex','0');
          function activateFromCard(e, source){ e.preventDefault(); var v = card.dataset.tier; if (v) selectByValue(v, source); }
          card.addEventListener('click',  function(e){ activateFromCard(e, 'card'); });
          card.addEventListener('keydown',function(e){ var k=e.key||e.code; if(k===' '||k==='Spacebar'||k==='Enter'){ activateFromCard(e, 'card_kbd'); }});
        });

        checkout.addEventListener('click', function(e){
          try { localStorage.setItem(storageKey, String(checkout.getAttribute('data-value') || '')); } catch(_){ }
          if (!currentTier) return;
          openCheckoutFor(currentTier, e);
        });
      }

      if(document.readyState !== 'loading') initPWYC(); else document.addEventListener('DOMContentLoaded', initPWYC);
      document.addEventListener('turbolinks:load', initPWYC);
      document.addEventListener('pageshow', initPWYC);
    })();
  </script>
</section>

{% schema %}
{
  "name": "Pricing - PWYC (Unified Slider)",
  "elements": [
    { "type": "header", "content": "Content" },
    { "type": "text", "id": "section_id", "label": "Section ID", "default": "pricing-pwyc-unified" },
    { "type": "text", "id": "eyebrow", "label": "Eyebrow", "default": "Pay‑What‑You‑Can" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "Choose a price that works for your family" },
    { "type": "textarea", "id": "subheading", "label": "Subheading", "default": "Every tier includes the full program. Pay‑it‑Forward funds scholarships." },

    { "type": "header", "content": "Tiers & Values" },
    { "type": "text", "id": "currency_symbol", "label": "Currency Symbol", "default": "$" },
    { "type": "range", "id": "min_value", "label": "Floor Value", "min": 1, "max": 1000, "step": 1, "default": 49 },
    { "type": "range", "id": "anchor_value", "label": "Anchor Value", "min": 1, "max": 2000, "step": 1, "default": 297 },
    { "type": "range", "id": "max_value", "label": "Pay‑It‑Forward Value", "min": 1, "max": 5000, "step": 1, "default": 449 },
    { "type": "range", "id": "default_value", "label": "Default Slider Value", "min": 1, "max": 5000, "step": 1, "default": 297 },

    { "type": "header", "content": "Labels & Descriptions" },
    { "type": "text", "id": "floor_title", "label": "Floor Title", "default": "Floor" },
    { "type": "textarea", "id": "floor_desc", "label": "Floor Description", "default": "Choose this if money is tight. You get everything." },
    { "type": "text", "id": "anchor_title", "label": "Anchor Title", "default": "Anchor" },
    { "type": "text", "id": "anchor_label", "label": "Anchor Chip Label", "default": "Recommended" },
    { "type": "textarea", "id": "anchor_desc", "label": "Anchor Description", "default": "Covers our costs and sustains the pay‑what‑you‑can model." },
    { "type": "text", "id": "forward_title", "label": "Pay‑It‑Forward Title", "default": "Pay‑It‑Forward" },
    { "type": "textarea", "id": "forward_desc", "label": "Pay‑It‑Forward Description", "default": "Funds a scholarship seat for another parent." },

    { "type": "header", "content": "CTA & Links" },
    { "type": "text", "id": "primary_cta_text", "label": "Primary CTA Text", "default": "Get lifetime access" },

    { "type": "action", "id": "checkout_url_floor", "label": "Checkout — Floor (URL or #action)", "default": "/checkout/spp-49" },
    { "type": "action", "id": "checkout_url_anchor", "label": "Checkout — Anchor (URL or #action)", "default": "/checkout/spp-297" },
    { "type": "action", "id": "checkout_url_forward", "label": "Checkout — Pay‑It‑Forward (URL or #action)", "default": "/checkout/spp-449" },

    { "type": "header", "content": "Optional Kajabi Offer IDs (uses Kajabi API if set)" },
    { "type": "offer", "id": "kajabi_offer_floor", "label": "Kajabi Offer — Floor", "info": "If set, opens Kajabi modal via API" },
    { "type": "offer", "id": "kajabi_offer_anchor", "label": "Kajabi Offer — Anchor", "info": "If set, opens Kajabi modal via API" },
    { "type": "offer", "id": "kajabi_offer_forward", "label": "Kajabi Offer — Pay‑It‑Forward", "info": "If set, opens Kajabi modal via API" },

    { "type": "header", "content": "Tier Colors" },
    { "type": "text", "id": "floor_color", "label": "Floor Color (CSS value)", "default": "var(--c-accent-teal)" },
    { "type": "text", "id": "anchor_color", "label": "Anchor Color (CSS value)", "default": "var(--c-brand-600)" },
    { "type": "text", "id": "forward_color", "label": "Pay‑It‑Forward Color (CSS value)", "default": "var(--c-accent-lemon)" },

    { "type": "header", "content": "Scholarship/Support" },
    { "type": "checkbox", "id": "show_scholarship", "label": "Show Scholarship Link", "default": true },
    { "type": "text", "id": "scholarship_text", "label": "Scholarship Link Text", "default": "Apply for scholarship" },
    { "type": "action", "id": "scholarship_link", "label": "Scholarship Link", "default": "#" },
    { "type": "checkbox", "id": "show_bottom_note", "label": "Show Bottom Note", "default": true },
    { "type": "textarea", "id": "bottom_note", "label": "Bottom Note (use [[link]] placeholder)", "default": "Need help covering even $49? [[link]]" },
    { "type": "action", "id": "bottom_note_link", "label": "Bottom Note Link", "default": "#" },
    { "type": "text", "id": "bottom_note_link_text", "label": "Bottom Note Link Text", "default": "Request a free scholarship." },

    { "type": "header", "content": "Scholarship Panel" },
    { "type": "checkbox", "id": "show_scholarship_panel", "label": "Show Scholarship Panel", "default": true },
    { "type": "text", "id": "scholarship_panel_heading", "label": "Panel Heading", "default": "Scholarships" },
    { "type": "textarea", "id": "scholarship_panel_intro", "label": "Panel Intro", "default": "If $49 is a stretch, we’ll spot you. We built this to be accessible. If finances are tight, request a scholarship—no essays, no shame. We’ll get you in." },
    { "type": "text", "id": "scholarship_bullet_one", "label": "Bullet #1", "default": "Quick request—2 minutes" },
    { "type": "text", "id": "scholarship_bullet_two", "label": "Bullet #2", "default": "Dignity-first: you don’t need to explain your life" },
    { "type": "text", "id": "scholarship_bullet_three", "label": "Bullet #3", "default": "Limited monthly seats, prioritized by need" },
    { "type": "text", "id": "scholarship_panel_cta", "label": "Panel CTA Text", "default": "Request a scholarship" }
  ],
  "presets": [
    { "name": "Pricing - PWYC (Unified Slider)", "category": "Offers & Pricing" }
  ]
}
{% endschema %}

{% comment %}
  Pricing - Pay‑What‑You‑Can (Slider)
  - Slider selects closest tier and updates label, description, and checkout URL
  - Quick tier buttons snap the slider and focus CTA
  - All copy and links configurable via schema
  - Section-only CSS and JS included to keep it self-contained
{% endcomment %}

<section id="pwyc-slider-{{ section.id }}" class="an-section an-theme"
         style="background: var(--c-white,#fff); color: var(--c-ink-900,#1B1B29)"
         data-url-floor="{{ section.settings.checkout_url_floor }}"
         data-url-anchor="{{ section.settings.checkout_url_anchor }}"
         data-url-forward="{{ section.settings.checkout_url_forward }}">
  <div class="an-container">
    <div class="pwyc-grid">
      <!-- Slider card -->
      <div class="an-card">
        {% if section.settings.eyebrow != blank %}
          <div class="an-eyebrow">{{ section.settings.eyebrow }}</div>
        {% endif %}
        {% if section.settings.heading != blank %}
          <h2 class="an-title-lg pwyc-heading">{{ section.settings.heading }}</h2>
        {% endif %}
        {% if section.settings.subheading != blank %}
          <p class="pwyc-sub">{{ section.settings.subheading }}</p>
        {% endif %}

        <!-- Quick tier buttons -->
        <div class="pwyc-quick" role="tablist" aria-label="Quick pricing tiers">
          <button type="button" class="an-btn-secondary pwyc-quick-btn" data-tier="{{ section.settings.min_value }}" data-evt="pwyc_tier_click" data-label="{{ section.settings.min_value }}">{{ section.settings.currency_symbol }}{{ section.settings.min_value }} — {{ section.settings.floor_title }}</button>
          <button type="button" class="an-btn-secondary pwyc-quick-btn" data-tier="{{ section.settings.anchor_value }}" data-evt="pwyc_tier_click" data-label="{{ section.settings.anchor_value }}">{{ section.settings.currency_symbol }}{{ section.settings.anchor_value }} — {{ section.settings.anchor_title }} <span class="pwyc-badge">{{ section.settings.anchor_label }}</span></button>
          <button type="button" class="an-btn-secondary pwyc-quick-btn" data-tier="{{ section.settings.max_value }}" data-evt="pwyc_tier_click" data-label="{{ section.settings.max_value }}">{{ section.settings.currency_symbol }}{{ section.settings.max_value }} — {{ section.settings.forward_title }}</button>
        </div>

        <!-- Slider -->
        <div class="pwyc-slider-wrap">
          <label id="pwyc-slider-label-{{ section.id }}" class="sr-only" for="pwyc-slider-input-{{ section.id }}">Choose your price</label>
          <input id="pwyc-slider-input-{{ section.id }}" type="range" min="{{ section.settings.min_value }}" max="{{ section.settings.max_value }}" step="1" value="{{ section.settings.default_value }}" class="pwyc-slider" role="slider" aria-orientation="horizontal" aria-labelledby="pwyc-slider-label-{{ section.id }}" aria-valuemin="{{ section.settings.min_value }}" aria-valuemax="{{ section.settings.max_value }}" aria-valuenow="{{ section.settings.default_value }}">
        </div>
        <div class="pwyc-scale">
          <span>{{ section.settings.currency_symbol }}{{ section.settings.min_value }}</span>
          <span>{{ section.settings.currency_symbol }}{{ section.settings.anchor_value }}</span>
          <span>{{ section.settings.currency_symbol }}{{ section.settings.max_value }}</span>
        </div>

        <div class="pwyc-readout" id="pwyc-readout-{{ section.id }}" aria-live="polite" aria-atomic="true" role="status">
          <div class="pwyc-price" id="pwyc-price-{{ section.id }}">{{ section.settings.currency_symbol }}{{ section.settings.default_value }}</div>
          <span class="an-chip" id="pwyc-label-{{ section.id }}">{{ section.settings.anchor_label }}</span>
        </div>
        <p class="pwyc-desc" id="pwyc-desc-{{ section.id }}">{{ section.settings.anchor_desc }}</p>

        <div class="pwyc-cta">
          <a id="pwyc-checkout-{{ section.id }}" href="{{ section.settings.checkout_url_anchor }}" class="an-btn-primary" data-evt="pwyc_checkout_click" data-label="slider" aria-describedby="pwyc-desc-{{ section.id }}" aria-label="{{ section.settings.primary_cta_text }} at {{ section.settings.currency_symbol }}{{ section.settings.default_value }}">{{ section.settings.primary_cta_text }}</a>
          {% if section.settings.show_scholarship %}
            <a href="{{ section.settings.scholarship_link }}" class="an-btn-secondary" data-evt="pwyc_cta" data-label="scholarship_link">{{ section.settings.scholarship_text }}</a>
          {% endif %}
        </div>

        {% if section.settings.whats_included != blank %}
          <div class="pwyc-included">
            <strong>{{ section.settings.whats_included_heading }}</strong> {{ section.settings.whats_included }}
          </div>
        {% endif %}
      </div>

      <!-- Quick tier cards -->
      <div>
        <div class="pwyc-tiers">
          <div class="an-card pwyc-tier">
            <div class="pwyc-tier-eyebrow">{{ section.settings.floor_title }}</div>
            <div class="pwyc-tier-amount">{{ section.settings.currency_symbol }}{{ section.settings.min_value }}</div>
            <p class="pwyc-tier-desc">{{ section.settings.floor_desc }}</p>
          </div>
          <div class="an-card pwyc-tier pwyc-tier--anchor">
            <div class="pwyc-tier-eyebrow">{{ section.settings.anchor_title }}</div>
            <div class="pwyc-tier-amount">{{ section.settings.currency_symbol }}{{ section.settings.anchor_value }}</div>
            <p class="pwyc-tier-desc">{{ section.settings.anchor_desc }}</p>
          </div>
          <div class="an-card pwyc-tier">
            <div class="pwyc-tier-eyebrow">{{ section.settings.forward_title }}</div>
            <div class="pwyc-tier-amount">{{ section.settings.currency_symbol }}{{ section.settings.max_value }}</div>
            <p class="pwyc-tier-desc">{{ section.settings.forward_desc }}</p>
          </div>
        </div>
        {% if section.settings.show_bottom_note %}
          <p class="pwyc-note" id="pwyc-scholarship-{{ section.id }}">{{ section.settings.bottom_note | replace: '[[link]]', '<a href="' | append: section.settings.bottom_note_link | append: '" data-evt="pwyc_cta" data-label="scholarship_request">' | append: section.settings.bottom_note_link_text | append: '</a>' }}</p>
        {% endif %}
      </div>
    </div>
  </div>


  <style>
    /* Ensure readable text regardless of global theme inversions */
    #pwyc-slider-{{ section.id }}{color:var(--c-ink-900);--pwyc-accent: {{ section.settings.anchor_color | default: 'var(--c-brand-600)' }}}
    #pwyc-slider-{{ section.id }} a{color:inherit}
    /* Visually hidden utility for accessible labels */
    #pwyc-slider-{{ section.id }} .sr-only{position:absolute!important;width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}
    .pwyc-grid{display:grid;gap:16px;grid-template-columns:1.2fr .8fr}
    .pwyc-heading{margin-bottom:4px}
    .pwyc-sub{font-size:.9rem;color:var(--c-ink-500)}
    .pwyc-slider-wrap{margin:16px 0 8px}
    .pwyc-slider{appearance:none;width:100%;height:8px;border-radius:8px;background:#F0EDFF;outline:none}
    /* Slider thumb styles */
    .pwyc-slider::-webkit-slider-thumb{appearance:none;width:20px;height:20px;border-radius:50%;background:var(--pwyc-accent);box-shadow:0 0 0 0 rgba(94,59,255,0.35);transition:transform var(--duration-fast) var(--motion-ease-standard), box-shadow var(--duration-fast) var(--motion-ease-standard)}
    .pwyc-slider:active::-webkit-slider-thumb{transform:scale(1.05)}
    .pwyc-slider:focus-visible::-webkit-slider-thumb{box-shadow:0 0 0 4px rgba(94,59,255,0.25)}
    .pwyc-slider::-moz-range-thumb{width:20px;height:20px;border:none;border-radius:50%;background:var(--pwyc-accent);transition:transform var(--duration-fast) var(--motion-ease-standard)}
    .pwyc-slider:focus-visible::-moz-range-thumb{outline:none;box-shadow:0 0 0 4px rgba(94,59,255,0.25)}
    .pwyc-scale{display:flex;justify-content:space-between;font-size:12px;color:var(--c-ink-500);margin-top:6px}
    .pwyc-readout{display:flex;align-items:center;gap:10px;margin:12px 0 8px;padding:8px 10px;border-radius:12px;border:1px solid transparent}
    .pwyc-price{font-size:28px;font-weight:700;color:var(--c-ink-900)}
    .pwyc-desc{font-size:.9rem;color:var(--c-ink-500)}
    .pwyc-cta{margin-top:14px;display:flex;gap:10px;flex-wrap:wrap}
    .pwyc-cta a:focus-visible{box-shadow:0 0 0 3px rgba(94,59,255,0.3);outline:0}
    /* Dynamic accent for primary CTA and scholarship links */
    #pwyc-slider-{{ section.id }} .an-btn-primary{background:var(--pwyc-accent)!important;border-color:var(--pwyc-accent)!important;color:var(--c-white)!important}
    #pwyc-slider-{{ section.id }} .an-btn-primary:hover{filter:brightness(.95)}
    #pwyc-slider-{{ section.id }} .pwyc-note a{color:var(--pwyc-accent);text-decoration:underline}
    #pwyc-slider-{{ section.id }} .pwyc-scholarship-panel a{color:var(--pwyc-accent);text-decoration:underline}
    #pwyc-slider-{{ section.id }} .pwyc-cta [data-label="scholarship_link"]{color:var(--pwyc-accent)!important;border-color:var(--pwyc-accent)!important;font-size:.9rem;padding:.5rem .75rem}
    .pwyc-included{margin-top:14px;background:linear-gradient(145deg,#EDEBFF,#F7F6FF);border-radius:16px;padding:12px}
    .pwyc-quick{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
    .pwyc-quick-btn{border-color:var(--border-medium)!important}
    .pwyc-quick-btn .pwyc-badge{font-size:11px;margin-left:6px;color:var(--c-ink-500)}
    .pwyc-tiers{display:flex;flex-wrap:wrap;gap:10px}
    .pwyc-tier{flex:1 1 180px}
    .pwyc-tier{cursor:pointer}
    .pwyc-tier.is-active{outline:2px solid var(--pwyc-accent);box-shadow:var(--glow-brand)}
    .pwyc-tier--anchor{border:1px solid var(--c-brand-600);box-shadow:var(--glow-brand)}
    .pwyc-tier-eyebrow{font-size:.85rem;color:var(--c-ink-500)}
    .pwyc-tier-amount{font-size:24px;font-weight:700;color:var(--c-ink-900)}
    .pwyc-tier-desc{font-size:.9rem;color:var(--c-ink-500)}
    .pwyc-tier .an-btn-secondary.is-active{background:var(--pwyc-accent)!important;color:var(--c-white)!important;border-color:var(--pwyc-accent)!important}
    .pwyc-tier.is-active{outline:2px solid var(--pwyc-accent);box-shadow:0 0 0 4px rgba(94,59,255,0.06)}
    .pwyc-note{font-size:.9rem;color:var(--c-ink-500);margin-top:10px}
    @media (max-width: 900px){.pwyc-grid{grid-template-columns:1fr}}
    @media (max-width: 600px){
      .pwyc-cta{flex-direction:column}
      .pwyc-cta a{width:100%}
    }
    /* Scholarship Panel */
    .pwyc-scholarship-panel{margin-top:16px;padding:14px;border:1px solid var(--border-medium);border-radius:16px;background:linear-gradient(145deg,#F8F8FF,#FFFFFF)}
    .pwyc-scholarship-panel h3{margin:0 0 6px;font-size:1.1rem;color:var(--c-ink-900)}
    .pwyc-scholarship-panel p{margin:0 0 8px;color:var(--c-ink-700)}
    .pwyc-scholarship-panel ul{margin:0 0 8px;padding-left:18px;color:var(--c-ink-700)}
    /* Highlight price box by tier */
    #pwyc-slider-{{ section.id }}[data-tier-key] .pwyc-readout{border-color:var(--pwyc-accent);box-shadow:0 0 0 4px rgba(94,59,255,0.06)}
  </style>

  <script>
    (function(){
      var ROOT_ID = 'pwyc-slider-{{ section.id }}';
      function initPWYC(){
        var root = document.getElementById(ROOT_ID);
        if(!root || root.dataset.inited === '1') return; root.dataset.inited = '1';
        var slider   = root.querySelector('#pwyc-slider-input-{{ section.id }}');
        var price    = root.querySelector('#pwyc-price-{{ section.id }}');
        var label    = root.querySelector('#pwyc-label-{{ section.id }}');
        var desc     = root.querySelector('#pwyc-desc-{{ section.id }}');
        var checkout = root.querySelector('#pwyc-checkout-{{ section.id }}');
        if(!slider || !price || !label || !desc || !checkout) return;
        var quickButtons = Array.prototype.slice.call(root.querySelectorAll('[data-tier]'));
        var quickCards   = Array.prototype.slice.call(root.querySelectorAll('.pwyc-tier'));
        var currency   = {{ section.settings.currency_symbol | json }};
        var storageKey = 'pwyc:lastSelected:{{ section.id }}';

        var tiers = [
          { v: {{ section.settings.min_value   | default: 49  }}, key:'floor',   chip: {{ section.settings.floor_title    | json }},   title: {{ section.settings.floor_title    | json }},   desc: {{ section.settings.floor_desc    | json }},   url: root.dataset.urlFloor   },
          { v: {{ section.settings.anchor_value| default: 297 }}, key:'anchor',  chip: {{ section.settings.anchor_label   | json }},   title: {{ section.settings.anchor_title   | json }},   desc: {{ section.settings.anchor_desc   | json }},   url: root.dataset.urlAnchor  },
          { v: {{ section.settings.max_value   | default: 449 }}, key:'forward', chip: {{ section.settings.forward_title  | json }},   title: {{ section.settings.forward_title  | json }},   desc: {{ section.settings.forward_desc  | json }},   url: root.dataset.urlForward }
        ];

        var colors = {
          floor:   {{ section.settings.floor_color   | default: 'var(--c-accent-teal)'  | json }},
          anchor:  {{ section.settings.anchor_color  | default: 'var(--c-brand-600)'    | json }},
          forward: {{ section.settings.forward_color | default: 'var(--c-accent-lemon)' | json }}
        };

        function closestTier(val){
          return tiers.reduce(function(best, t){
            return Math.abs(t.v - val) < Math.abs(best.v - val) ? t : best;
          }, tiers[0]);
        }
        function applyAccentForTier(t){
          try { root.style.setProperty('--pwyc-accent', colors[t.key] || colors.anchor); root.setAttribute('data-tier-key', t.key); } catch(e) {}
        }
        function toggleActiveStates(selectedV){
          quickButtons.forEach(function(btn){
            var isActive = parseInt(btn.dataset.tier, 10) === selectedV;
            btn.classList.toggle('is-active', isActive);
            btn.setAttribute('aria-pressed', isActive ? 'true' : 'false');
            var card = btn.closest && btn.closest('.pwyc-tier');
            if(card) card.classList.toggle('is-active', isActive);
          });
        }
        function render(t, opts){
          price.textContent = currency + t.v;
          label.textContent = t.chip;
          desc.textContent  = t.desc;
          if(t.url) checkout.href = t.url;
          slider.value = String(t.v);
          slider.setAttribute('aria-valuenow', String(t.v));
          slider.setAttribute('aria-valuetext', currency + t.v + ' — ' + t.chip);
          checkout.setAttribute('data-value', String(t.v));
          checkout.setAttribute('aria-label', {{ section.settings.primary_cta_text | json }} + ' at ' + currency + t.v + ' — ' + t.chip);
          applyAccentForTier(t);
          toggleActiveStates(t.v);
          try { localStorage.setItem(storageKey, String(t.v)); } catch(e){}
          try { if(window.gtag){ gtag('event','pwyc_view',{ value:t.v, tier_key:t.key }); } } catch(e){}
          if(opts && opts.focusCta){
            var prefersReduced = false;
            try { prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches; } catch(err){}
            if(prefersReduced){ checkout.focus(); }
            else { checkout.scrollIntoView({behavior:'smooth', block:'center'}); }
          }
        }
        function selectByValue(value, source){
          var t = closestTier(parseInt(value,10));
          render(t, { focusCta: source !== 'slider' });
          try { if(window.gtag){ gtag('event','pwyc_tier_click',{ value:t.v, tier_key:t.key, source:source }); } } catch(e){}
        }
        var storedVal = (function(){ try{ var v = parseInt(localStorage.getItem(storageKey),10); return isNaN(v) ? null : v; } catch(e){ return null; }})();
        var initial   = closestTier(storedVal != null ? storedVal : parseInt(slider.value,10));
        render(initial);
        try{
          var qp = new URLSearchParams(window.location.search);
          var qpVal = qp.get('tier') || qp.get('pwyc') || qp.get('amount');
          if(qpVal){
            var byKey = tiers.find(function(t){ return t.key === String(qpVal).toLowerCase(); });
            if(byKey) render(byKey); else { var n = parseInt(qpVal,10); if(!isNaN(n)) render(closestTier(n)); }
          }
        }catch(e){}
        slider.addEventListener('input', function(){ selectByValue(slider.value, 'slider'); });
        quickButtons.forEach(function(btn){
          btn.addEventListener('click', function(e){ e.preventDefault(); e.stopPropagation(); selectByValue(btn.dataset.tier, 'button'); });
          btn.addEventListener('keydown', function(e){ var k=e.key||e.code; if(k===' '||k==='Spacebar'||k==='Enter'){ e.preventDefault(); selectByValue(btn.dataset.tier, 'button_kbd'); }});
        });
        quickCards.forEach(function(card){
          card.setAttribute('role','button'); card.setAttribute('tabindex','0');
          card.addEventListener('click', function(e){ if(e.target&&e.target.closest&&e.target.closest('[data-tier]')) return; e.preventDefault(); var innerBtn=card.querySelector('[data-tier]'); if(innerBtn) selectByValue(innerBtn.dataset.tier, 'card'); });
          card.addEventListener('keydown', function(e){ var k=e.key||e.code; if(k===' '||k==='Spacebar'||k==='Enter'){ e.preventDefault(); var innerBtn=card.querySelector('[data-tier]'); if(innerBtn) selectByValue(innerBtn.dataset.tier, 'card_kbd'); }});
        });
        checkout.addEventListener('click', function(){ try { localStorage.setItem(storageKey, String(checkout.getAttribute('data-value') || '')); } catch(e) {} });
      }
      if(document.readyState !== 'loading') initPWYC(); else document.addEventListener('DOMContentLoaded', initPWYC);
      document.addEventListener('turbolinks:load', initPWYC);
      document.addEventListener('pageshow', initPWYC);
    })();
  </script>
</section>

{% schema %}
{
  "name": "Pricing - PWYC Slider",
  "elements": [
    { "type": "header", "content": "Content" },
    { "type": "text", "id": "section_id", "label": "Section ID", "default": "pricing-pwyc-slider" },
    { "type": "text", "id": "eyebrow", "label": "Eyebrow", "default": "Pay‑What‑You‑Can" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "Choose a price that works for your family" },
    { "type": "textarea", "id": "subheading", "label": "Subheading", "default": "Every tier includes the full program. Pay‑it‑Forward funds scholarships." },

    { "type": "header", "content": "Tiers & Values" },
    { "type": "text", "id": "currency_symbol", "label": "Currency Symbol", "default": "$" },
    { "type": "range", "id": "min_value", "label": "Floor Value", "min": 1, "max": 1000, "step": 1, "default": 49 },
    { "type": "range", "id": "anchor_value", "label": "Anchor Value", "min": 1, "max": 2000, "step": 1, "default": 297 },
    { "type": "range", "id": "max_value", "label": "Pay‑It‑Forward Value", "min": 1, "max": 5000, "step": 1, "default": 449 },
    { "type": "range", "id": "default_value", "label": "Default Slider Value", "min": 1, "max": 5000, "step": 1, "default": 297 },

    { "type": "header", "content": "Labels & Descriptions" },
    { "type": "text", "id": "floor_title", "label": "Floor Title", "default": "Floor" },
    { "type": "textarea", "id": "floor_desc", "label": "Floor Description", "default": "Choose this if money is tight. You get everything." },
    { "type": "text", "id": "anchor_title", "label": "Anchor Title", "default": "Anchor" },
    { "type": "text", "id": "anchor_label", "label": "Anchor Chip Label", "default": "Recommended" },
    { "type": "textarea", "id": "anchor_desc", "label": "Anchor Description", "default": "Covers our costs and sustains the pay‑what‑you‑can model." },
    { "type": "text", "id": "forward_title", "label": "Pay‑It‑Forward Title", "default": "Pay‑It‑Forward" },
    { "type": "textarea", "id": "forward_desc", "label": "Pay‑It‑Forward Description", "default": "Funds a scholarship seat for another parent." },

    { "type": "header", "content": "CTA & Links" },
    { "type": "text", "id": "primary_cta_text", "label": "Primary CTA Text", "default": "Get lifetime access" },
    { "type": "action", "id": "checkout_url_floor", "label": "Checkout URL — Floor", "default": "/checkout/spp-49" },
    { "type": "action", "id": "checkout_url_anchor", "label": "Checkout URL — Anchor", "default": "/checkout/spp-297" },
    { "type": "action", "id": "checkout_url_forward", "label": "Checkout URL — Pay‑It‑Forward", "default": "/checkout/spp-449" },

    { "type": "header", "content": "Tier Colors" },
    { "type": "text", "id": "floor_color", "label": "Floor Color (CSS value)", "default": "var(--c-accent-teal)" },
    { "type": "text", "id": "anchor_color", "label": "Anchor Color (CSS value)", "default": "var(--c-brand-600)" },
    { "type": "text", "id": "forward_color", "label": "Pay‑It‑Forward Color (CSS value)", "default": "var(--c-accent-lemon)" },

    { "type": "header", "content": "Scholarship/Support" },
    { "type": "checkbox", "id": "show_scholarship", "label": "Show Scholarship Link", "default": true },
    { "type": "text", "id": "scholarship_text", "label": "Scholarship Link Text", "default": "Apply for scholarship" },
    { "type": "action", "id": "scholarship_link", "label": "Scholarship Link", "default": "#" },
    { "type": "checkbox", "id": "show_bottom_note", "label": "Show Bottom Note", "default": true },
    { "type": "textarea", "id": "bottom_note", "label": "Bottom Note (use [[link]] placeholder)", "default": "Need help covering even $49? [[link]]" },
    { "type": "action", "id": "bottom_note_link", "label": "Bottom Note Link", "default": "#" },
    { "type": "text", "id": "bottom_note_link_text", "label": "Bottom Note Link Text", "default": "Request a free scholarship." },

    { "type": "header", "content": "Scholarship Panel" },
    { "type": "checkbox", "id": "show_scholarship_panel", "label": "Show Scholarship Panel", "default": true },
    { "type": "text", "id": "scholarship_panel_heading", "label": "Panel Heading", "default": "Scholarships" },
    { "type": "textarea", "id": "scholarship_panel_intro", "label": "Panel Intro", "default": "If $49 is a stretch, we’ll spot you. We built this to be accessible. If finances are tight, request a scholarship—no essays, no shame. We’ll get you in." },
    { "type": "text", "id": "scholarship_bullet_one", "label": "Bullet #1", "default": "Quick request—2 minutes" },
    { "type": "text", "id": "scholarship_bullet_two", "label": "Bullet #2", "default": "Dignity-first: you don’t need to explain your life" },
    { "type": "text", "id": "scholarship_bullet_three", "label": "Bullet #3", "default": "Limited monthly seats, prioritized by need" },
    { "type": "text", "id": "scholarship_panel_cta", "label": "Panel CTA Text", "default": "Request a scholarship" },

    { "type": "header", "content": "What's Included" },
    { "type": "text", "id": "whats_included_heading", "label": "Heading", "default": "What you get:" },
    { "type": "textarea", "id": "whats_included", "label": "Description", "default": "all 6 modules • printable scripts • monthly Q&A • searchable replays • lifetime access." }
  ],
  "presets": [
    { "name": "Pricing - PWYC Slider", "category": "Offers & Pricing" }
  ]
}
{% endschema %}


